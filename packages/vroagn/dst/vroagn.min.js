var T=async t=>t>0?new Promise(h=>setTimeout(h,t)):null;var k=t=>t.split(";")[0].trim().toLowerCase(),A=t=>{let h=t.match(/\.([^./?]+)(?:[?#]|$)/);return h?h[1].toLowerCase():null},D=function(t,h,d){let f=h.get("Content-Type");if(f)return k(f);if(d&&d.Accept){let r=d.Accept.split(",");for(let c of r)if(c.trim()!=="*/*")return k(c)}let l=A(t);return l||""};var S={method:"get",retryCodes:[429,503,504],retryDelay:500},L=t=>{t={...S,...structuredClone(t)};let h=0,d=0,f=0,l=null,r=async e=>{let o=Date.now(),u=e-(o-h);h=o+(u>0?u:0),await T(u)},c=e=>new Promise(o=>{l&&clearTimeout(l),l=setTimeout(o,e)}),s=async e=>{if(e.maxRequests!==void 0&&f>=e.maxRequests)return[new Error("Maximum request limit reached"),null,null];f++;let o={cache:e.cache,credentials:e.credentials,headers:e.headers,method:e.method,mode:e.mode,redirect:e.redirect,body:e.body?JSON.stringify(e.body):void 0},u=(e.domain||"")+(e.path||"");if(e.queryParams&&(u+="?"+new URLSearchParams(e.queryParams).toString()),e.timeout){let i=e.abort||new AbortController;o.signal=i.signal,setTimeout(()=>i.abort(),e.timeout)}let m=async()=>{let i=await(e.fetch??fetch)(u,o);if(!i.ok)return[new Error("Invalid response"),i,null];try{let a,x=!1,w=e.type||D(u,i.headers,e.headers);if(e.parsers){for(let b of e.parsers)if(x=b.types.includes(w),x){a=await b.parser(i,e,w);break}}if(!x)switch(w.toLowerCase()){case"arraybuffer":a=await i.arrayBuffer();break;case"blob":a=await i.blob();break;case"formdata":a=await i.formData();break;case"text/plain":case"text":case"txt":a=await i.text();break;case"text/html-partial":case"html-partial":a=await i.text();let b=document.createElement("template");b.innerHTML=a,a=b.content.childNodes;break;case"text/html":case"html":a=await i.text(),a=new DOMParser().parseFromString(a,"text/html");break;case"application/json":case"text/json":case"json":a=await i.json();break;case"image/svg+xml":case"svg":a=await i.text(),a=new DOMParser().parseFromString(a,"image/svg+xml");break;case"application/xml":case"text/xml":case"xml":a=await i.text(),a=new DOMParser().parseFromString(a,"application/xml");break}return[null,i,a]}catch(a){return[a||new Error("Thrown parsing error is falsy"),i,null]}},p=async()=>{let i=0,a=e.retryAttempts||0,x=e.retryDelay||0;for(;i<a;){let[w,b,P]=await m();if(!w)return[w,b,P];if(!e.retryCodes?.includes(b.status||200))return[new Error("Invalid status code"),b,P];if(i++,i>=a)return[new Error("Too many retry attempts"),b,P];let R=x*Math.pow(2,i-1),q=b.headers.get("Retry-After");if(q){let j=parseInt(q,10);if(!isNaN(j))R=Math.max(R,j*1e3);else{let C=new Date(q).getTime();if(!isNaN(C)){let N=Date.now();R=Math.max(R,C-N)}}}await T(R)}return m()},[y,n,g]=await p();return n.ok?[y,n,g]:[new Error(n.statusText),n,g]};return async e=>{let o={...t,...structuredClone(e)};t.headers&&(o.headers={...t.headers,...o.headers}),o.debounce&&await c(o.debounce),o.delay&&await T(o.delay),o.throttle&&await r(o.throttle),o.maxConcurrency&&d>=o.maxConcurrency&&await new Promise(m=>{let p=null,y=()=>{d>=o.maxConcurrency?p=requestAnimationFrame(y):(p&&clearInterval(p),m(null))};p=requestAnimationFrame(y)}),d++;let u=await s(o);return d--,u}};var V=["tsv","text/tab-separated-values"],U=t=>({types:t?.types||["csv","text/csv",...V],parser:async(h,d,f)=>{let l={columnDelimiter:V.includes(f)?"	":",",rowDelimiter:`
`,escapeCharacter:'"',...t},r=await h.text(),c=[],s=[],e="",o=!1;for(let u=0;u<r.length;u++){let m=r[u],p=r[u+1];m===l.escapeCharacter?p===l.escapeCharacter&&o?(e+=l.escapeCharacter,u++):o=!o:m===l.columnDelimiter&&!o?(s.push(e),e=""):m===l.rowDelimiter&&!o?(s.push(e),e="",c.push(s),s=[]):e+=m}if(e&&(s.push(e),e=""),s.length>0&&c.push(s),l.hasHeaders){let u=c[0];return c.slice(1).map(m=>u.reduce((p,y,n)=>(p[y]=m[n]||"",p),{}))}return c}});var K=(t={})=>({types:t.types||["ini"],parser:async(h,d)=>{let f=await h.text(),l={},r=f.split(/\r?\n/).map(s=>s.trim()),c="";for(let s of r)if(!(s===""||s.startsWith(";")||s.startsWith("#")))if(s.startsWith("[")&&s.endsWith("]"))c=s.slice(1,-1).trim(),l[c]||(l[c]={});else{let[e,...o]=s.split("="),u=o.join("=").trim();c===""?(l.global||(l.global={}),l.global[e.trim()]=u):l[c][e.trim()]=u}return l}});var O=t=>t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'")?t.slice(1,-1):t==="true"||t==="false"?t==="true":isNaN(Number(t))?t.match(/^\d{4}-\d{2}-\d{2}(T\d{2}:\d{2}:\d{2}(.\d+)?(Z|[+-]\d{2}:\d{2})?)?$/)?new Date(t):t:Number(t),E=t=>{let h={},d="",f="",l=!1,r="",c=!1;for(let s=1;s<t.length-1;s++){let e=t[s];!l&&(e==='"'||e==="'")?(l=!0,r=e):l&&e===r?l=!1:!l&&e==="="?c=!0:!l&&e===","?(h[d.trim()]=O(f.trim()),d="",f="",c=!1):c?f+=e:d+=e}return d&&(h[d.trim()]=O(f.trim())),h},$=(t={})=>({types:t.types||["toml","application/toml"],parser:async(h,d)=>{let f=await h.text(),l={},r=l,c=null,s=null,e=null,o=f.split(/\r?\n/);for(let u=0;u<o.length;u++){let m=o[u].trim();if(!(m===""||m.startsWith("#"))){if(s!==null){m.endsWith(e)?(s+=m.slice(0,-e.length),r[Object.keys(r).pop()]=s,s=null,e=null):s+=m+`
`;continue}if(m.startsWith("[")&&m.endsWith("]")){let p=m.slice(1,-1).trim();r=l;let y=p.split(".");for(let n of y)r[n]||(r[n]={}),r=r[n];c=null}else if(m.startsWith("[[")&&m.endsWith("]]")){let y=m.slice(2,-2).trim().split("."),n=l;for(let a=0;a<y.length-1;a++)n[y[a]]||(n[y[a]]={}),n=n[y[a]];let g=y[y.length-1];n[g]||(n[g]=[]);let i={};n[g].push(i),r=i,c=null}else{let[p,...y]=m.split("="),n=y.join("=").trim();n.startsWith('"""')||n.startsWith("'''")?(e=n.slice(0,3),s=n.slice(3),n.endsWith(e)&&(r[p.trim()]=s.slice(0,-3),s=null,e=null)):n.startsWith("{")&&n.endsWith("}")?r[p.trim()]=E(n):n.startsWith("[")&&!n.endsWith("]")?(c=[],n=n.slice(1).trim()):c!==null?n.endsWith("]")?(c.push(O(n.slice(0,-1).trim())),r[p.trim()]=c,c=null):c.push(O(n)):r[p.trim()]=O(n)}}}return l}});var W=(t,h)=>{if(t==="null"||t==="~")return null;if(t==="true")return!0;if(t==="false")return!1;if(t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'"))return t.slice(1,-1);if(!isNaN(Number(t)))return Number(t);if(t.startsWith("[")&&t.endsWith("]"))return t.slice(1,-1).split(",").map(d=>W(d.trim(),h));if(t.startsWith("*")){let d=t.slice(1).trim();return h[d]}if(t.includes("!!")){let[d,f]=t.split(" ");switch(d){case"!!int":return parseInt(f);case"!!float":return parseFloat(f);case"!!str":return f;case"!!bool":return f.toLowerCase()==="true";default:return f}}return t},J=(t={})=>({types:t.types||["yaml","application/yaml","text/yaml"],parser:async(h,d)=>{let f=(await h.text()).split(`
`),l={},r=l,c=[l],s=0,e=null,o=[],u={};for(let m=0;m<f.length;m++){let p=f[m].trimEnd();if(p.trim().startsWith("#"))continue;let y=p.search(/\S/);if(e!==null)if(y>s){o.push(p.trim());continue}else r[e]=o.join(`
`),e=null,o=[];if(y>s)c.push(r),r=r[Object.keys(r).pop()];else if(y<s)for(;y<s;)c.pop(),r=c[c.length-1],s-=t.indentSize||2;if(s=y,p.trim()==="-"){if(!Array.isArray(r)){let a=Object.keys(r).pop();r[a]=[],r=r[a]}r.push({}),r=r[r.length-1];continue}let n=p.indexOf(":");if(n===-1)continue;let g=p.slice(0,n).trim(),i=p.slice(n+1).trim();if(i.startsWith("&")){let a=i.slice(1).split(" ")[0];i=i.slice(a.length+2).trim();let x=W(i,u);u[a]=x,r[g]=x}else if(i.startsWith("*")){let a=i.slice(1).trim();r[g]=u[a]}else i==="|"||i===">"?(e=g,s+=t.indentSize||2):i?r[g]=W(i,u):r[g]={}}return l}});export{L as create,U as csvParser,K as iniParser,$ as tomlParser,J as yamlParser};
//# sourceMappingURL=vroagn.min.js.map
