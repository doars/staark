var V=Object.defineProperty;var R=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var F=(t,i,n)=>i in t?V(t,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[i]=n,T=(t,i)=>{for(var n in i||(i={}))z.call(i,n)&&F(t,n,i[n]);if(R)for(var n of R(i))U.call(i,n)&&F(t,n,i[n]);return t};var b=(t,i,n)=>new Promise((p,u)=>{var m=e=>{try{a(n.next(e))}catch(s){u(s)}},r=e=>{try{a(n.throw(e))}catch(s){u(s)}},a=e=>e.done?p(e.value):Promise.resolve(e.value).then(m,r);a((n=n.apply(t,i)).next())});var C=t=>{if(typeof t=="object"){let i=Array.isArray(t)?[]:{};for(let n in t)i[n]=C(t[n]);return i}return t};var D=t=>b(null,null,function*(){return t>0?new Promise(i=>setTimeout(i,t)):null});var O=t=>t.split(";")[0].trim().toLowerCase(),K=t=>{let i=t.match(/\.([^./?]+)(?:[?#]|$)/);return i?i[1].toLowerCase():null},I=(t,i,n)=>{let p=i.get("Content-Type");if(p)return O(p);if(n&&n.Accept){let m=n.Accept.split(",");for(let r of m)if(r.trim()!=="*/*")return O(r)}let u=K(t);return u||""};var Q={method:"get",retryCodes:[429,503,504],retryDelay:500},v=t=>{t=T(T({},Q),C(t));let i=0,n=0,p=0,u=null,m=e=>b(null,null,function*(){let s=Date.now(),h=e-(s-i);i=s+(h>0?h:0),yield D(h)}),r=e=>new Promise(s=>{u&&clearTimeout(u),u=setTimeout(s,e)}),a=e=>b(null,null,function*(){if(e.maxRequests!==void 0&&p>=e.maxRequests)return[new Error("Maximum request limit reached"),null,null];p++;let s={cache:e.cache,credentials:e.credentials,headers:e.headers,method:e.method,mode:e.mode,redirect:e.redirect,body:e.body?JSON.stringify(e.body):void 0},h=(e.domain||"")+(e.path||"");if(e.queryParams&&(h+="?"+new URLSearchParams(e.queryParams).toString()),e.timeout){let o=e.abort||new AbortController;s.signal=o.signal,setTimeout(()=>o.abort(),e.timeout)}let y=()=>b(null,null,function*(){var x;let o=yield((x=e.fetch)!=null?x:fetch)(h,s);if(!o.ok)return[new Error("Invalid response"),o,null];try{let l,W=!1,k=e.type||I(h,o.headers,e.headers);if(e.parsers){for(let g of e.parsers)if(W=g.types.includes(k),W){l=yield g.parser(o,e,k);break}}if(!W)switch(k.toLowerCase()){case"arraybuffer":l=yield o.arrayBuffer();break;case"blob":l=yield o.blob();break;case"formdata":l=yield o.formData();break;case"text/plain":case"text":case"txt":l=yield o.text();break;case"text/html-partial":case"html-partial":l=yield o.text();let g=document.createElement("template");g.innerHTML=l,l=g.content.childNodes;break;case"text/html":case"html":l=yield o.text(),l=new DOMParser().parseFromString(l,"text/html");break;case"application/json":case"text/json":case"json":l=yield o.json();break;case"image/svg+xml":case"svg":l=yield o.text(),l=new DOMParser().parseFromString(l,"image/svg+xml");break;case"application/xml":case"text/xml":case"xml":l=yield o.text(),l=new DOMParser().parseFromString(l,"application/xml");break}return[null,o,l]}catch(l){return[l||new Error("Thrown parsing error is falsy"),o,null]}}),f=()=>b(null,null,function*(){var W;let o=0,x=e.retryAttempts||0,l=e.retryDelay||0;for(;o<x;){let[k,g,P]=yield y();if(!k)return[k,g,P];if(!((W=e.retryCodes)!=null&&W.includes(g.status||200)))return[new Error("Invalid status code"),g,P];if(o++,o>=x)return[new Error("Too many retry attempts"),g,P];let N=l*Math.pow(2,o-1),q=g.headers.get("Retry-After");if(q){let E=parseInt(q,10);if(!isNaN(E))N=Math.max(N,E*1e3);else{let j=new Date(q).getTime();if(!isNaN(j)){let M=Date.now();N=Math.max(N,j-M)}}}yield D(N)}return y()}),[w,d,c]=yield f();return d.ok?[w,d,c]:[new Error(d.statusText),d,c]});return e=>b(null,null,function*(){let s=T(T({},t),C(e));t.headers&&(s.headers=T(T({},t.headers),s.headers)),s.debounce&&(yield r(s.debounce)),s.delay&&(yield D(s.delay)),s.throttle&&(yield m(s.throttle)),s.maxConcurrency&&n>=s.maxConcurrency&&(yield new Promise(y=>{let f=null,w=()=>{n>=s.maxConcurrency?f=requestAnimationFrame(w):(f&&clearInterval(f),y(null))};f=requestAnimationFrame(w)})),n++;let h=yield a(s);return n--,h})};var L=["tsv","text/tab-separated-values"],re=t=>({types:(t==null?void 0:t.types)||["csv","text/csv",...L],parser:(i,n,p)=>b(null,null,function*(){let u=T({columnDelimiter:L.includes(p)?"	":",",rowDelimiter:"\n",escapeCharacter:'"'},t),m=yield i.text(),r=[],a=[],e="",s=!1;for(let h=0;h<m.length;h++){let y=m[h],f=m[h+1];y===u.escapeCharacter?f===u.escapeCharacter&&s?(e+=u.escapeCharacter,h++):s=!s:y===u.columnDelimiter&&!s?(a.push(e),e=""):y===u.rowDelimiter&&!s?(a.push(e),e="",r.push(a),a=[]):e+=y}if(e&&(a.push(e),e=""),a.length>0&&r.push(a),u.hasHeaders){let h=r[0];return r.slice(1).map(y=>h.reduce((f,w,d)=>(f[w]=y[d]||"",f),{}))}return r})});var ie=(t={})=>({types:t.types||["ini"],parser:(i,n,p)=>b(null,null,function*(){let u=yield i.text(),m={},r=u.split(/\r?\n/).map(e=>e.trim()),a="";for(let e of r)if(!(e===""||e.startsWith(";")||e.startsWith("#")))if(e.startsWith("[")&&e.endsWith("]"))a=e.slice(1,-1).trim(),m[a]||(m[a]={});else{let[s,...h]=e.split("="),y=h.join("=").trim();a===""?(m.global||(m.global={}),m.global[s.trim()]=y):m[a][s.trim()]=y}return m})});var A=t=>t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'")?t.slice(1,-1):t==="true"||t==="false"?t==="true":isNaN(Number(t))?t.match(/^\d{4}-\d{2}-\d{2}(T\d{2}:\d{2}:\d{2}(.\d+)?(Z|[+-]\d{2}:\d{2})?)?$/)?new Date(t):t:Number(t),$=t=>{let i={},n="",p="",u=!1,m="",r=!1;for(let a=1;a<t.length-1;a++){let e=t[a];!u&&(e==='"'||e==="'")?(u=!0,m=e):u&&e===m?u=!1:!u&&e==="="?r=!0:!u&&e===","?(i[n.trim()]=A(p.trim()),n="",p="",r=!1):r?p+=e:n+=e}return n&&(i[n.trim()]=A(p.trim())),i},ce=(t={})=>({types:t.types||["toml","application/toml"],parser:(i,n,p)=>b(null,null,function*(){let u=yield i.text(),m={},r=m,a=null,e=null,s=null,h=u.split(/\r?\n/);for(let y=0;y<h.length;y++){let f=h[y].trim();if(!(f===""||f.startsWith("#"))){if(e!==null){f.endsWith(s)?(e+=f.slice(0,-s.length),r[Object.keys(r).pop()]=e,e=null,s=null):e+=f+"\n";continue}if(f.startsWith("[")&&f.endsWith("]")){let w=f.slice(1,-1).trim();r=m;let d=w.split(".");for(let c of d)r[c]||(r[c]={}),r=r[c];a=null}else if(f.startsWith("[[")&&f.endsWith("]]")){let d=f.slice(2,-2).trim().split("."),c=m;for(let l=0;l<d.length-1;l++)c[d[l]]||(c[d[l]]={}),c=c[d[l]];let o=d[d.length-1];c[o]||(c[o]=[]);let x={};c[o].push(x),r=x,a=null}else{let[w,...d]=f.split("="),c=d.join("=").trim();c.startsWith('"""')||c.startsWith("'''")?(s=c.slice(0,3),e=c.slice(3),c.endsWith(s)&&(r[w.trim()]=e.slice(0,-3),e=null,s=null)):c.startsWith("{")&&c.endsWith("}")?r[w.trim()]=$(c):c.startsWith("[")&&!c.endsWith("]")?(a=[],c=c.slice(1).trim()):a!==null?c.endsWith("]")?(a.push(A(c.slice(0,-1).trim())),r[w.trim()]=a,a=null):a.push(A(c)):r[w.trim()]=A(c)}}}return m})});var S=(t,i)=>{if(t==="null"||t==="~")return null;if(t==="true")return!0;if(t==="false")return!1;if(t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'"))return t.slice(1,-1);if(!isNaN(Number(t)))return Number(t);if(t.startsWith("[")&&t.endsWith("]"))return t.slice(1,-1).split(",").map(n=>S(n.trim(),i));if(t.startsWith("*")){let n=t.slice(1).trim();return i[n]}if(t.includes("!!")){let[n,p]=t.split(" ");switch(n){case"!!int":return parseInt(p);case"!!float":return parseFloat(p);case"!!str":return p;case"!!bool":return p.toLowerCase()==="true";default:return p}}return t},me=(t={})=>({types:t.types||["yaml","application/yaml","text/yaml"],parser:(i,n,p)=>b(null,null,function*(){let u=(yield i.text()).split("\n"),m={},r=m,a=[m],e=0,s=null,h=[],y={};for(let f=0;f<u.length;f++){let w=u[f].trimEnd();if(w.trim().startsWith("#"))continue;let d=w.search(/\S/);if(s!==null)if(d>e){h.push(w.trim());continue}else r[s]=h.join("\n"),s=null,h=[];if(d>e)a.push(r),r=r[Object.keys(r).pop()];else if(d<e)for(;d<e;)a.pop(),r=a[a.length-1],e-=t.indentSize||2;if(e=d,w.trim()==="-"){if(!Array.isArray(r)){let l=Object.keys(r).pop();r[l]=[],r=r[l]}r.push({}),r=r[r.length-1];continue}let c=w.indexOf(":");if(c===-1)continue;let o=w.slice(0,c).trim(),x=w.slice(c+1).trim();if(x.startsWith("&")){let l=x.slice(1).split(" ")[0];x=x.slice(l.length+2).trim();let W=S(x,y);y[l]=W,r[o]=W}else if(x.startsWith("*")){let l=x.slice(1).trim();r[o]=y[l]}else x==="|"||x===">"?(s=o,e+=t.indentSize||2):x?r[o]=S(x,y):r[o]={}}return m})});export{v as create,re as csvParser,ie as iniParser,ce as tomlParser,me as yamlParser};
