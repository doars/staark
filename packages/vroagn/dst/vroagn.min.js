var M=Object.defineProperty;var V=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var E=(e,r,n)=>r in e?M(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n,R=(e,r)=>{for(var n in r||(r={}))H.call(r,n)&&E(e,n,r[n]);if(V)for(var n of V(r))z.call(r,n)&&E(e,n,r[n]);return e};var b=(e,r,n)=>new Promise((d,m)=>{var a=t=>{try{s(n.next(t))}catch(u){m(u)}},i=t=>{try{s(n.throw(t))}catch(u){m(u)}},s=t=>t.done?d(t.value):Promise.resolve(t.value).then(a,i);s((n=n.apply(e,r)).next())});var P=e=>{if(typeof e=="object")if(Array.isArray(e)){let r=[];for(let n=0;n<e.length;n++)r.push(P(e[n]));e=r}else{let r={};for(let n in e)r[n]=P(e[n]);e=r}return e};var j=e=>b(void 0,null,function*(){return e>0?new Promise(r=>setTimeout(r,e)):null});var F=e=>e.split(";")[0].trim().toLowerCase(),K=e=>{let r=e.match(/\.([^./?]+)(?:[?#]|$)/);return r?r[1].toLowerCase():null},I=function(e,r,n){let d=r.get("Content-Type");if(d)return F(d);if(n&&n.Accept){let a=n.Accept.split(",");for(let i of a)if(i.trim()!=="*/*")return F(i)}let m=K(e);return m||""};var U={method:"get",retryCodes:[429,503,504],retryDelay:500},ee=e=>{e=R(R({},U),P(e));let r=0,n=0,d=0,m=null,a=t=>b(void 0,null,function*(){let u=Date.now(),f=t-(u-r);r=u+(f>0?f:0),yield j(f)}),i=t=>new Promise(u=>{m&&clearTimeout(m),m=setTimeout(u,t)}),s=t=>b(void 0,null,function*(){if(t.maxRequests!==void 0&&d>=t.maxRequests)return[new Error("Maximum request limit reached"),null,null];d++;let u={cache:t.cache,credentials:t.credentials,headers:t.headers,method:t.method,mode:t.mode,redirect:t.redirect,body:t.body?JSON.stringify(t.body):void 0},f=(t.domain||"")+(t.path||"");if(t.queryParams&&(f+="?"+new URLSearchParams(t.queryParams).toString()),t.timeout){let l=t.abort||new AbortController;u.signal=l.signal,setTimeout(()=>l.abort(),t.timeout)}let o=()=>b(void 0,null,function*(){var g;let l=yield((g=t.fetch)!=null?g:fetch)(f,u);if(!l.ok)return[new Error("Invalid response"),l,null];try{let y,T=!1,O=t.type||I(f,l.headers,t.headers);if(t.parsers){for(let x of t.parsers)if(T=x.types.includes(O),T){y=yield x.parser(l,t,O);break}}if(!T)switch(O.toLowerCase()){case"arraybuffer":y=yield l.arrayBuffer();break;case"blob":y=yield l.blob();break;case"formdata":y=yield l.formData();break;case"text/plain":case"text":case"txt":y=yield l.text();break;case"text/html-partial":case"html-partial":y=yield l.text();let x=document.createElement("template");x.innerHTML=y,y=x.content.childNodes;break;case"text/html":case"html":y=yield l.text(),y=new DOMParser().parseFromString(y,"text/html");break;case"application/json":case"text/json":case"json":y=yield l.json();break;case"image/svg+xml":case"svg":y=yield l.text(),y=new DOMParser().parseFromString(y,"image/svg+xml");break;case"application/xml":case"text/xml":case"xml":y=yield l.text(),y=new DOMParser().parseFromString(y,"application/xml");break}return[null,l,y]}catch(y){return[y||new Error("Thrown parsing error is falsy"),l,null]}}),p=()=>b(void 0,null,function*(){var T;let l=0,g=t.retryAttempts||0,y=t.retryDelay||0;for(;l<g;){let[O,x,D]=yield o();if(!O)return[O,x,D];if(!((T=t.retryCodes)!=null&&T.includes(x.status||200)))return[new Error("Invalid status code"),x,D];if(l++,l>=g)return[new Error("Too many retry attempts"),x,D];let C=y*Math.pow(2,l-1),k=x.headers.get("Retry-After");if(k){let N=parseInt(k,10);if(!isNaN(N))C=Math.max(C,N*1e3);else{let S=new Date(k).getTime();if(!isNaN(S)){let L=Date.now();C=Math.max(C,S-L)}}}yield j(C)}return o()}),[h,c,w]=yield p();return c.ok?[h,c,w]:[new Error(c.statusText),c,w]});return t=>b(void 0,null,function*(){let u=R(R({},e),P(t));e.headers&&(u.headers=R(R({},e.headers),u.headers)),u.debounce&&(yield i(u.debounce)),u.delay&&(yield j(u.delay)),u.throttle&&(yield a(u.throttle)),u.maxConcurrency&&n>=u.maxConcurrency&&(yield new Promise(o=>{let p=null,h=()=>{n>=u.maxConcurrency?p=requestAnimationFrame(h):(p&&clearInterval(p),o(null))};p=requestAnimationFrame(h)})),n++;let f=yield s(u);return n--,f})};var A={},se=(e={})=>(d,...m)=>b(void 0,[d,...m],function*(r,n={}){var u,f;if(n.cache==="no-store")return yield fetch(r,n);let a=(u=e.name)!=null?u:"vroagn-cache",i=null;A[a]?i=A[a]:i=A[a]=yield caches.open(a);let s=()=>b(void 0,null,function*(){let o=yield fetch(r,n),p=o.headers.get("Cache-Control"),h=(p==null?void 0:p.includes("no-store"))||!1;if(o.status===200&&!h){let c=o.clone(),w=new Headers(c.headers);w.set("date",new Date().toUTCString());let l=new Response(c.body,{status:c.status,statusText:c.statusText,headers:w});yield i.put(r,l)}return o});if(n.cache)switch(n.cache){case"reload":return yield i.delete(r),yield s();case"no-cache":{let o=yield i.match(r);if(o){let p=o.headers.get("Cache-Control");if(p&&p.includes("no-cache"))return yield i.delete(r),yield s()}return yield s()}case"force-cache":{let o=yield i.match(r);return o||(yield s())}case"only-if-cached":{let o=yield i.match(r);if(!o)throw new Error("Request failed because no cached response is available");return o}default:break}let t=yield i.match(r);if(t){let o=t.headers.get("Cache-Control"),p=t.headers.get("Expires");if(o||p){if(o){let h=o.includes("no-store"),c=o.includes("no-cache"),w=o.match(/max-age=(\d+)/),l=w?parseInt(w[1]):null;if(h||c)return yield i.delete(r),s();if(l!==null){let g=new Date(t.headers.get("date")||0).getTime();if((Date.now()-g)/1e3>l)return yield i.delete(r),s()}}if(p){let h=new Date(p).getTime();if(Date.now()>h)return yield i.delete(r),s()}}else{let h=t.headers.get("date");if(h){let c=new Date(h).getTime();if(Date.now()-c>((f=e.ttl)!=null?f:36e5))return yield i.delete(r),s()}}return t}return s()});var Y=["tsv","text/tab-separated-values"],ie=e=>({types:(e==null?void 0:e.types)||["csv","text/csv",...Y],parser:(r,n,d)=>b(void 0,null,function*(){let m=R({columnDelimiter:Y.includes(d)?"	":",",rowDelimiter:"\n",escapeCharacter:'"'},e),a=yield r.text(),i=[],s=[],t="",u=!1;for(let f=0;f<a.length;f++){let o=a[f],p=a[f+1];o===m.escapeCharacter?p===m.escapeCharacter&&u?(t+=m.escapeCharacter,f++):u=!u:o===m.columnDelimiter&&!u?(s.push(t),t=""):o===m.rowDelimiter&&!u?(s.push(t),t="",i.push(s),s=[]):t+=o}if(t&&(s.push(t),t=""),s.length>0&&i.push(s),m.hasHeaders){let f=i[0];return i.slice(1).map(o=>f.reduce((p,h,c)=>(p[h]=o[c]||"",p),{}))}return i})});var le=(e={})=>({types:e.types||["ini"],parser:(r,n)=>b(void 0,null,function*(){let d=yield r.text(),m={},a=d.split(/\r?\n/).map(s=>s.trim()),i="";for(let s of a)if(!(s===""||s.startsWith(";")||s.startsWith("#")))if(s.startsWith("[")&&s.endsWith("]"))i=s.slice(1,-1).trim(),m[i]||(m[i]={});else{let[t,...u]=s.split("="),f=u.join("=").trim();i===""?(m.global||(m.global={}),m.global[t.trim()]=f):m[i][t.trim()]=f}return m})});var W=e=>e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'")?e.slice(1,-1):e==="true"||e==="false"?e==="true":isNaN(Number(e))?e.match(/^\d{4}-\d{2}-\d{2}(T\d{2}:\d{2}:\d{2}(.\d+)?(Z|[+-]\d{2}:\d{2})?)?$/)?new Date(e):e:Number(e),B=e=>{let r={},n="",d="",m=!1,a="",i=!1;for(let s=1;s<e.length-1;s++){let t=e[s];!m&&(t==='"'||t==="'")?(m=!0,a=t):m&&t===a?m=!1:!m&&t==="="?i=!0:!m&&t===","?(r[n.trim()]=W(d.trim()),n="",d="",i=!1):i?d+=t:n+=t}return n&&(r[n.trim()]=W(d.trim())),r},pe=(e={})=>({types:e.types||["toml","application/toml"],parser:(r,n)=>b(void 0,null,function*(){let d=yield r.text(),m={},a=m,i=null,s=null,t=null,u=d.split(/\r?\n/);for(let f=0;f<u.length;f++){let o=u[f].trim();if(!(o===""||o.startsWith("#"))){if(s!==null){o.endsWith(t)?(s+=o.slice(0,-t.length),a[Object.keys(a).pop()]=s,s=null,t=null):s+=o+"\n";continue}if(o.startsWith("[")&&o.endsWith("]")){let p=o.slice(1,-1).trim();a=m;let h=p.split(".");for(let c of h)a[c]||(a[c]={}),a=a[c];i=null}else if(o.startsWith("[[")&&o.endsWith("]]")){let h=o.slice(2,-2).trim().split("."),c=m;for(let g=0;g<h.length-1;g++)c[h[g]]||(c[h[g]]={}),c=c[h[g]];let w=h[h.length-1];c[w]||(c[w]=[]);let l={};c[w].push(l),a=l,i=null}else{let[p,...h]=o.split("="),c=h.join("=").trim();c.startsWith('"""')||c.startsWith("'''")?(t=c.slice(0,3),s=c.slice(3),c.endsWith(t)&&(a[p.trim()]=s.slice(0,-3),s=null,t=null)):c.startsWith("{")&&c.endsWith("}")?a[p.trim()]=B(c):c.startsWith("[")&&!c.endsWith("]")?(i=[],c=c.slice(1).trim()):i!==null?c.endsWith("]")?(i.push(W(c.slice(0,-1).trim())),a[p.trim()]=i,i=null):i.push(W(c)):a[p.trim()]=W(c)}}}return m})});var q=(e,r)=>{if(e==="null"||e==="~")return null;if(e==="true")return!0;if(e==="false")return!1;if(e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'"))return e.slice(1,-1);if(!isNaN(Number(e)))return Number(e);if(e.startsWith("[")&&e.endsWith("]"))return e.slice(1,-1).split(",").map(n=>q(n.trim(),r));if(e.startsWith("*")){let n=e.slice(1).trim();return r[n]}if(e.includes("!!")){let[n,d]=e.split(" ");switch(n){case"!!int":return parseInt(d);case"!!float":return parseFloat(d);case"!!str":return d;case"!!bool":return d.toLowerCase()==="true";default:return d}}return e},de=(e={})=>({types:e.types||["yaml","application/yaml","text/yaml"],parser:(r,n)=>b(void 0,null,function*(){let d=(yield r.text()).split("\n"),m={},a=m,i=[m],s=0,t=null,u=[],f={};for(let o=0;o<d.length;o++){let p=d[o].trimEnd();if(p.trim().startsWith("#"))continue;let h=p.search(/\S/);if(t!==null)if(h>s){u.push(p.trim());continue}else a[t]=u.join("\n"),t=null,u=[];if(h>s)i.push(a),a=a[Object.keys(a).pop()];else if(h<s)for(;h<s;)i.pop(),a=i[i.length-1],s-=e.indentSize||2;if(s=h,p.trim()==="-"){if(!Array.isArray(a)){let g=Object.keys(a).pop();a[g]=[],a=a[g]}a.push({}),a=a[a.length-1];continue}let c=p.indexOf(":");if(c===-1)continue;let w=p.slice(0,c).trim(),l=p.slice(c+1).trim();if(l.startsWith("&")){let g=l.slice(1).split(" ")[0];l=l.slice(g.length+2).trim();let y=q(l,f);f[g]=y,a[w]=y}else if(l.startsWith("*")){let g=l.slice(1).trim();a[w]=f[g]}else l==="|"||l===">"?(t=w,s+=e.indentSize||2):l?a[w]=q(l,f):a[w]={}}return m})});export{se as cacheFetch,ee as create,ie as csvParser,le as iniParser,pe as tomlParser,de as yamlParser};
//# sourceMappingURL=vroagn.min.js.map
