var p=f=>f?Array.isArray(f)?f:[f]:void 0;var a="n";var N=(f,i,r)=>(i&&(typeof i!="object"||i._===a||Array.isArray(i))&&(r=i,i=void 0),{_:a,a:i,c:p(r),t:f.toUpperCase()});var l=f=>{var r;let i=[];for(let e of f.childNodes)if(e instanceof Text)i.push((r=e.textContent)!=null?r:"");else{let o={};for(let c of e.attributes)o[c.name]=c.value;i.push(N(e.nodeName,o,l(e)))}return i};var m=(f,i,r)=>{if(i)for(let e in i){let o=i[e];if(o){let c=typeof o;if(c==="function"){let n=r==null?void 0:r[e];n!==o&&(n&&f.removeEventListener(e,n),f.addEventListener(e,o))}else if(e==="class"){if(typeof o=="object")if(Array.isArray(o))o=o.join(" ");else{let n="";for(let s in o)o[s]&&(n+=" "+s);o=n}f.className=o}else if(e==="style"&&typeof o=="object"){for(let n in o){let s=o[n];n.includes("-",1)?f.style.setProperty(n,s):f.style[n]=s}if(r&&r[e]&&typeof r[e]=="object"&&!Array.isArray(r[e]))for(let n in r[e])o[n]||(n.includes("-",1)?f.style.removeProperty(n):f.style[n]=null)}else o===!0?o="true":c!=="string"&&(o=o.toString()),f.setAttribute(e,o)}}if(r)for(let e in r)(!i||!i[e])&&(typeof r[e]=="function"?f.removeEventListener(e,r[e]):e==="class"?f.className="":e==="style"?f.style.cssText="":e==="value"?f.value="":f.removeAttribute(e))},d=(f,i,r)=>{let e=0,o=0;if(i)for(;e<i.length;e++){let c=i[e],n=!1;if(r)for(let s=e-o;s<r.length;s++){let y=r[s];if(y.t&&c.t===y.t||!y.t&&!c.t){n=!0,e!==s+o&&(f.insertBefore(f.childNodes[s+o],f.childNodes[e]),r.splice(e-o,0,r.splice(s,1)[0])),c.t?(m(f.childNodes[e],c.a,y.a),d(f.childNodes[e],c.c,y.c)):y!==c&&(f.childNodes[e].textContent=c);break}}if(!n){let s;c.t?(s=document.createElement(c.t),m(s,c.a),d(s,c.c)):s=document.createTextNode(c),f.insertBefore(s,f.childNodes[e]),o++}}if(r){let c=r.length+o;if(c>=e)for(let n=c-1;n>=e;n--)f.childNodes[n].remove()}},U=(f,i)=>{let r=typeof f=="string"?document.querySelector(f)||document.body.appendChild(document.createElement("div")):f;if(typeof i=="string")try{i=JSON.parse(i)}catch(e){i=null}return i||(i=l(r)),e=>{e=p(e),d(r,e,i),i=e}};export{N as node,U as prepare};
