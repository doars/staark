var a=o=>o?Array.isArray(o)?o:[o]:void 0;var p="n";var t=(o,i,r)=>((typeof i!="object"||i._===p||Array.isArray(i))&&(r=i,i=void 0),{_:p,a:i,c:a(r),t:o.toUpperCase()});var l=o=>{var r;let i=[];for(let e of o.childNodes)if(e instanceof Text)i.push((r=e.textContent)!=null?r:"");else{let f={};for(let c of e.attributes)f[c.name]=c.value;i.push(t(e.nodeName,f,l(e)))}return i};var N=(o,i,r)=>{if(i)for(let e in i){let f=i[e];if(f){let c=typeof f;if(c==="function"){let n=r==null?void 0:r[e];n!==f&&(n&&o.removeEventListener(e,n),o.addEventListener(e,f))}else if(e==="class"){if(typeof f=="object")if(Array.isArray(f))f=f.join(" ");else{let n="";for(let s in f)f[s]&&(n+=" "+s);f=n}o.className=f}else if(e==="style"&&typeof f=="object"){for(let n in f){let s=f[n];n.includes("-",1)?o.style.setProperty(n,s):o.style[n]=s}if(r&&r[e]&&typeof r[e]=="object"&&!Array.isArray(r[e]))for(let n in r[e])f[n]||(n.includes("-",1)?o.style.removeProperty(n):o.style[n]=null)}else f===!0?f="true":c!=="string"&&(f=f.toString()),o.setAttribute(e,f)}}if(r)for(let e in r)(!i||!i[e])&&(typeof r[e]=="function"?o.removeEventListener(e,r[e]):e==="class"?o.className="":e==="style"?o.style.cssText="":e==="value"?o.value="":o.removeAttribute(e))},d=(o,i,r)=>{let e=0,f=0;if(i)for(;e<i.length;e++){let c=i[e],n=!1;if(r)for(let s=e-f;s<r.length;s++){let y=r[s];if(y.t&&c.t===y.t||!y.t&&!c.t){n=!0,e!==s+f&&(o.insertBefore(o.childNodes[s+f],o.childNodes[e]),r.splice(e-f,0,r.splice(s,1)[0])),c.t?(N(o.childNodes[e],c.a,y.a),d(o.childNodes[e],c.c,y.c)):y!==c&&(o.childNodes[e].textContent=c);break}}if(!n){let s;c.t?(s=document.createElement(c.t),N(s,c.a),d(s,c.c)):s=document.createTextNode(c),o.insertBefore(s,o.childNodes[e]),f++}}if(r){let c=r.length+f;if(c>=e)for(let n=c-1;n>=e;n--)o.childNodes[n].remove()}},U=(o,i)=>{let r=typeof o=="string"?document.querySelector(o)||document.body.appendChild(document.createElement("div")):o;if(typeof i=="string")try{i=JSON.parse(i)}catch(e){i=null}return i||(i=l(r)),e=>{e=a(e),d(r,e,i),i=e}};export{t as node,U as prepare};
