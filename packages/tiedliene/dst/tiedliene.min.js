var o=i=>{if(typeof i=="object"){let r=Array.isArray(i)?[]:{};for(let e in i)r[e]=o(i[e]);return r}return i};var l=(i,r,e)=>{let n=i;for(let t=0;t<r.length-1;t++){let f=r[t];f in n||(n[f]={}),n=n[f]}n[r[r.length-1]]=o(e)},m=(i,r)=>{let e=i;for(let n=0;n<r.length-1;n++)if(e=e[r[n]],!e)return;Array.isArray(e)?e.splice(parseInt(r[r.length-1]),1):delete e[r[r.length-1]]},c=(i,r,e=[])=>{let n=[];for(let t in i){let f=[...e,t];t in r?typeof i[t]=="object"&&typeof r[t]=="object"?n.unshift(...c(i[t],r[t],f)):i[t]!==r[t]&&n.unshift({type:"set",path:f,old:o(i[t]),new:o(r[t])}):n.unshift({type:"delete",path:f,old:o(i[t])})}for(let t in r)t in i||n.unshift({type:"set",path:[...e,t],new:o(r[t])});return n},u=(i,r)=>{for(let e of r)e.type==="set"?l(i,e.path,e.new):e.type==="delete"&&m(i,e.path);return i},y=(i,r)=>{for(let e of r)e.type==="set"?e.old===void 0?m(i,e.path):l(i,e.path,e.old):e.type==="delete"&&l(i,e.path,e.old);return i};var H=function(i,r){i=o(i),r=Object.assign({maximumHistory:50},r);let e=[],n=[];return{get:()=>o(i),set:t=>{t=o(t);let f=c(i,t);if(f.length>0){if(e.push(f),r.maximumHistory&&e.length>r.maximumHistory)for(let s=e.length-r.maximumHistory;s>0;s--)e.shift();n.splice(0)}return i=t,o(i)},undo:()=>{if(e.length>0){let t=e.pop();if(t){if(n.push(t),r.maximumHistory&&n.length>r.maximumHistory)for(let f=n.length-r.maximumHistory;f>0;f--)n.shift();i=y(i,t)}}return o(i)},redo:()=>{if(n.length>0){let t=n.pop();if(t){if(e.push(t),r.maximumHistory&&e.length>r.maximumHistory)for(let f=e.length-r.maximumHistory;f>0;f--)e.shift();i=u(i,t)}}return o(i)}}};export{u as applyDiff,c as determineDiff,H as manageState,y as revertDiff};
