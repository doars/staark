(()=>{var y=(e,r)=>{let i=window;for(let n=0;n<e.length-1;n++)(typeof i[e[n]]!="object"||!Array.isArray(i[e[n]]))&&(i[e[n]]={}),i=i[e[n]];i[e[e.length-1]]=r};var o=e=>{if(typeof e=="object"){let r=Array.isArray(e)?[]:{};for(let i in e)r[i]=o(e[i]);return r}return e};var s=(e,r,i)=>{let n=e;for(let t=0;t<r.length-1;t++){let f=r[t];f in n||(n[f]={}),n=n[f]}n[r[r.length-1]]=o(i)},h=(e,r)=>{let i=e;for(let n=0;n<r.length-1;n++)if(i=i[r[n]],!i)return;Array.isArray(i)?i.splice(parseInt(r[r.length-1]),1):delete i[r[r.length-1]]},l=(e,r,i=[])=>{let n=[];for(let t in e){let f=[...i,t];t in r?typeof e[t]=="object"&&typeof r[t]=="object"?n.unshift(...l(e[t],r[t],f)):e[t]!==r[t]&&n.unshift({type:"set",path:f,old:o(e[t]),new:o(r[t])}):n.unshift({type:"delete",path:f,old:o(e[t])})}for(let t in r)t in e||n.unshift({type:"set",path:[...i,t],new:o(r[t])});return n},m=(e,r)=>{for(let i of r)i.type==="set"?s(e,i.path,i.new):i.type==="delete"&&h(e,i.path);return e},c=(e,r)=>{for(let i of r)i.type==="set"?i.old===void 0?h(e,i.path):s(e,i.path,i.old):i.type==="delete"&&s(e,i.path,i.old);return e};var d=function(e,r){e=o(e),r=Object.assign({maximumHistory:50},r);let i=[],n=[];return{get:()=>o(e),set:t=>{t=o(t);let f=l(e,t);if(f.length>0){if(i.push(f),r.maximumHistory&&i.length>r.maximumHistory)for(let u=i.length-r.maximumHistory;u>0;u--)i.shift();n.splice(0)}return e=t,o(e)},undo:()=>{if(i.length>0){let t=i.pop();if(t){if(n.push(t),r.maximumHistory&&n.length>r.maximumHistory)for(let f=n.length-r.maximumHistory;f>0;f--)n.shift();e=c(e,t)}}return o(e)},redo:()=>{if(n.length>0){let t=n.pop();if(t){if(i.push(t),r.maximumHistory&&i.length>r.maximumHistory)for(let f=i.length-r.maximumHistory;f>0;f--)i.shift();e=m(e,t)}}return o(e)}}};y(["tiedliene"],{determineDiff:l,applyDiff:m,revertDiff:c,manageState:d});})();
