var _=(J)=>G(J)||[],G=(J)=>J?Array.isArray(J)?J:[J]:void 0;var v=(J,K,X)=>{let W=J?K:X;if(typeof W==="function")W=W();return _(W)};var I="n";var L=(J,K,X)=>{if(K&&(typeof K!=="object"||K._===I||Array.isArray(K)))X=K,K=void 0;return{_:I,a:K,c:G(X),t:J}};var k=new Proxy({},{get:(J,K)=>{if(J[K])return J[K];let X=K[0].toLowerCase()+K.substring(1).replace(/([A-Z])/g,(W)=>"-"+W.toLowerCase());return J[K]=(W,Y)=>L(X,W,Y)}});var H={attribute:0,class:1,id:2,type:3},M=(J)=>{let K=J.length,X=0,W="",Y={},$="",Z=!0,z=H.type,x=()=>{if($){switch(z){case H.attribute:Y[$]=Z===!0?!0:Z,Z=!0;break;case H.class:if(!Y.class){Y.class=$;break}Y.class+=" "+$;break;case H.id:Y.id=$;break;case H.type:W=$;break}$=""}},q,D,E=()=>{D=0;while(X<K){if(q=J[X],X++,q==="="){Z="",q=J[X];let U=q==='"',V=q==="'";if(U||V)Z+=q,X++;while(X<K){if(q=J[X],U&&q==='"'||V&&q==="'"){Z+=q,X++;break}else if(!U&&!V&&q==="]")break;Z+=q,X++}if(Z[0]==='"'&&Z[Z.length-1]==='"'||Z[0]==="'"&&Z[Z.length-1]==="'")Z=Z.substring(1,Z.length-1);while(X<K)if(q=J[X],X++,q==="]")break;break}else if(q==="["){D++;continue}else if(q==="]"){if(D--,D<0)break;continue}$+=q}x()};while(X<K){if(q=J[X],X++,q==="#"){x(),z=H.id;continue}else if(q==="."){x(),z=H.class;continue}else if(q==="["){x(),z=H.attribute,E();continue}$+=q}return[W,Y]};var l=new Proxy({},{get:(J,K)=>{if(J[K])return J[K];let X=K[0].toLowerCase()+K.substring(1).replace(/([A-Z])/g,(W)=>"-"+W.toLowerCase());return J[K]=(W,Y)=>{let $;if(W){let[Z,z]=M(W);$=z}return L(X,$,Y)}}});var j=0,c=(J)=>J+"-"+j++;var o=(J,K,X)=>{let W;if(K&&J in K&&K[J])W=K[J];else W=X;if(typeof W==="function")W=W();return _(W)};var a=(J,K)=>({_:I,r:J,m:K});var WJ=(J,K)=>{let[X,W]=M(J);return{_:I,a:W,c:G(K),t:X}};var P=["base","br","hr","img","input","link","meta","source","wbr"],F=/[A-Z]+(?![a-z])|[A-Z]/g,B=(J,K)=>(K?"-":"")+J,R=(J)=>{let K="";if(J)for(let X in J){let W=J[X];if(W!==null&&W!==void 0){let Y=typeof W;if(Y==="boolean")W=W?"true":"false";else if(Y!=="string")W=W.toString();if(X==="class"){if(typeof W==="object")if(Array.isArray(W))W=W.join(" ");else{let $="";for(let Z in W)if(W[Z])$+=" "+Z;W=$}}else if(X==="style"){if(typeof W==="object")if(Array.isArray(W))W=W.join(";");else{let $="";for(let Z in W){let z=W[Z];if(Z=Z.replace(F,B).toLowerCase(),Array.isArray(z))$+=";"+Z+":"+z.join(" ");else if(W)$+=";"+Z+":"+W}W=$}}K+=" "+X+'="'+W+'"'}}return K},w=(J)=>{let K="";if(J){for(let X of J)if(X)if(X.t)if(K+="<"+X.t.toLocaleLowerCase()+R(X.a),P.includes(X.t))K+="/>";else{if(K+=">",X.c)K+=w(X.c);K+="</"+X.t.toLocaleLowerCase()+">"}else K+=" "+X+" "}return K},A=(J)=>{return J=G(J),[w(J),J]},S=(J,K)=>{if(!K)K={};let X=(Y)=>{let $="";if(Y){for(let Z of Y)if(Z)if(Z.m)$+=X(G(Z.r(K,Z.m)));else if(Z.t)if($+="<"+Z.t.toLocaleLowerCase()+R(Z.a),P.includes(Z.t))$+="/>";else{if($+=">",Z.c)$+=X(Z.c);$+="</"+Z.t.toLocaleLowerCase()+">"}else $+=" "+Z+" "}return $},W=G(J(K));return[X(W),W]},Q=(J)=>{if(typeof J==="number"||typeof J==="boolean")return String(J);if(typeof J==="string")return'"'+J.replace(/"/g,"\\\"")+'"';if(Array.isArray(J))return"["+J.map((K)=>Q(K)).join(",")+"]";if(typeof J==="object")return"{"+Object.keys(J).filter((W)=>!W.startsWith("_")).map((W)=>'"'+W+'":'+Q(J[W])+'"').join(",")+"}";return"null"},$J=(J)=>{let[K,X]=A(J);return[K,Q(X)]},qJ=(J,K)=>{if(!K)K={};let[X,W]=S(J,K);return[X,Q(W),JSON.stringify(K)]};export{$J as stringifyPatchFull,A as stringifyPatch,qJ as stringifyFull,S as stringify,L as node,WJ as nde,a as memo,o as match,c as identifier,l as fctory,k as factory,v as conditional};
